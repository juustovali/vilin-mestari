<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vilin Mestari Sijoitus Voitot</title>
  <style>
    /* Teemat */
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #f4f7fa;
      color: #333;
      transition: background-color 0.3s, color 0.3s;
    }
    [data-theme="dark"] body {
      background: #121212;
      color: #e0e0e0;
    }
    [data-theme="blue"] body {
      background: #e3f2fd;
      color: #0d47a1;
    }

    /* Buttonit */
    button {
      cursor: pointer;
      padding: 0.4rem 1rem;
      margin: 0.2rem;
      border-radius: 4px;
      border: none;
      background-color: #2196f3;
      color: white;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #1976d2;
    }
    [data-theme="dark"] button {
      background-color: #444;
      color: #eee;
    }
    [data-theme="dark"] button:hover {
      background-color: #666;
    }
    [data-theme="blue"] button {
      background-color: #1a73e8;
      color: white;
    }
    [data-theme="blue"] button:hover {
      background-color: #155ab6;
    }

    /* Lomake */
    form > div {
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-bottom: 0.3rem;
    }
    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      max-width: 300px;
      padding: 0.4rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    /* Taulukko */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      padding: 0.5rem;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background-color: #ddd;
    }
    [data-theme="dark"] th {
      background-color: #333;
    }

    /* Teeman valintapainikkeet */
    #themeButtons button {
      margin-right: 0.5rem;
    }
  </style>
</head>
<body data-theme="light">

  <h1>Vilin Mestari Sijoitus Voitot</h1>

  <div id="themeButtons">
    <button id="lightBtn">Vaalea</button>
    <button id="darkBtn">Tumma</button>
    <button id="blueBtn">Sininen</button>
  </div>

  <form id="addSkinForm" aria-label="Lisää uusi skin">
    <div>
      <label for="name">Skinin nimi</label>
      <input id="name" name="name" type="text" required />
    </div>
    <div>
      <label for="buyPrice">Ostohinta (€)</label>
      <input id="buyPrice" name="buyPrice" type="number" step="0.01" required />
    </div>
    <div>
      <label for="sellPrice">Myyntihinta (€)</label>
      <input id="sellPrice" name="sellPrice" type="number" step="0.01" required />
    </div>
    <div>
      <label for="condition">Kunto</label>
      <select id="condition" name="condition" required>
        <option value="">Valitse...</option>
        <option value="Factory New">Factory New</option>
        <option value="Minimal Wear">Minimal Wear</option>
        <option value="Field-Tested">Field-Tested</option>
        <option value="Well-Worn">Well-Worn</option>
        <option value="Battle-Scarred">Battle-Scarred</option>
      </select>
    </div>
    <div>
      <label for="purchaseSource">Ostettu</label>
      <select id="purchaseSource" name="purchaseSource" required>
        <option value="">Valitse...</option>
        <option value="Steam">Steam</option>
        <option value="CSFloat">CSFloat</option>
      </select>
    </div>
    <button type="submit" id="addSkinBtn">Lisää skin</button>
  </form>

  <table id="skinsTable" aria-label="Skinit taulukko">
    <thead>
      <tr>
        <th>Nimi</th>
        <th>Ostohinta (€)</th>
        <th>Myyntihinta (€)</th>
        <th>Kunto</th>
        <th>Ostolähde</th>
        <th>Voitto (€)</th>
        <th>Toiminnot</th>
      </tr>
    </thead>
    <tbody>
      <!-- Skinit renderöidään tänne -->
    </tbody>
  </table>

  <script>
    const addSkinForm = document.getElementById('addSkinForm');
    const skinsTableBody = document.querySelector('#skinsTable tbody');
    let skins = [];
    let editIndex = -1;

    // Teemapainikkeet
    const lightBtn = document.getElementById('lightBtn');
    const darkBtn = document.getElementById('darkBtn');
    const blueBtn = document.getElementById('blueBtn');

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
    }

    lightBtn.addEventListener('click', () => setTheme('light'));
    darkBtn.addEventListener('click', () => setTheme('dark'));
    blueBtn.addEventListener('click', () => setTheme('blue'));

    // Lomakkeen käsittely
    addSkinForm.addEventListener('submit', (e) => {
      e.preventDefault();

      const name = addSkinForm.name.value.trim();
      const buyPrice = parseFloat(addSkinForm.buyPrice.value);
      const sellPrice = parseFloat(addSkinForm.sellPrice.value);
      const condition = addSkinForm.condition.value;
      const purchaseSource = addSkinForm.purchaseSource.value;

      if(!name || isNaN(buyPrice) || isNaN(sellPrice) || !condition || !purchaseSource) {
        alert('Täytä kaikki kentät oikein.');
        return;
      }

      const newSkin = { name, buyPrice, sellPrice, condition, purchaseSource };

      if(editIndex === -1) {
        skins.push(newSkin);
      } else {
        skins[editIndex] = newSkin;
        editIndex = -1;
        addSkinForm.querySelector('button[type="submit"]').textContent = 'Lisää skin';
      }

      addSkinForm.reset();
      renderSkins();
    });

    // Renderöi skin-taulukko
    function renderSkins() {
      skinsTableBody.innerHTML = '';
      skins.forEach((skin, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${skin.name}</td>
          <td>${skin.buyPrice.toFixed(2)}</td>
          <td>${skin.sellPrice.toFixed(2)}</td>
          <td>${skin.condition}</td>
          <td>${skin.purchaseSource}</td>
          <td>${(skin.sellPrice - skin.buyPrice).toFixed(2)}</td>
          <td>
            <button class="edit-btn" aria-label="Muokkaa skin ${skin.name}" data-index="${i}">Muokkaa</button>
            <button class="delete-btn" aria-label="Poista skin ${skin.name}" data-index="${i}">Poista</button>
          </td>
        `;
        skinsTableBody.appendChild(tr);
      });

      // Lisää event listenerit muokkaus- ja poistonapeille
      document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const i = parseInt(e.target.dataset.index);
          editIndex = i;
          const skin = skins[i];
          addSkinForm.name.value = skin.name;
          addSkinForm.buyPrice.value = skin.buyPrice;
          addSkinForm.sellPrice.value = skin.sellPrice;
          addSkinForm.condition.value = skin.condition;
          addSkinForm.purchaseSource.value = skin.purchaseSource;
          addSkinForm.querySelector('button[type="submit"]').textContent = 'Tallenna muutokset';
        });
      });

      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const i = parseInt(e.target.dataset.index);
          if(confirm(`Haluatko varmasti poistaa skinin "${skins[i].name}"?`)) {
            skins.splice(i, 1);
            if(editIndex === i) {
              editIndex = -1;
              addSkinForm.reset();
              addSkinForm.querySelector('button[type="submit"]').textContent = 'Lisää skin';
            }
            renderSkins();
          }
        });
      });
    }

    renderSkins();
  </script>
</body>
</html>